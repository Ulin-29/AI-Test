<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

  <header class="fixed top-0 left-0 right-0 h-[90px] bg-white border-b border-gray-200 z-50">
      <div class="flex items-center h-full px-6">
        <img src="assets/Logo.png" class="h-11 w-auto scale-[1.7] object-contain relative top-[-12px] ml-8" alt="Logo Telkom" />
      </div>
      
      <div class="absolute top-4 right-9">
        <button id="profileBtn" class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-200 hover:bg-gray-300 focus:outline-none shadow-lg">
          <img src="{% if user.photo %}/assets/uploads/{{ user.photo }}{% else %}assets/usericon.png{% endif %}" class="w-11 h-11 rounded-full object-cover shadow-md ring-2 ring-white" />
        </button>
        <div id="profileMenu" class="hidden absolute right-0 mt-4 w-52 bg-white text-gray-800 rounded-lg shadow-lg py-2 text-sm">
          <a href="/home" class="flex items-center px-4 py-2 hover:text-blue-600"><img src="assets/beranda.png" alt="Beranda" class="w-5 h-5 mr-3" />Beranda</a>
          <a href="/profile" class="flex items-center px-4 py-2 hover:text-blue-600"><img src="assets/profilsaya.png" alt="Profil" class="w-5 h-5 mr-3" />Profil Saya</a>
          <a href="/logout" class="flex items-center px-4 py-2 text-red-500 hover:text-red-700"><img src="assets/logout.png" alt="Logout" class="w-5 h-5 mr-3" />Logout</a>
        </div>
      </div>
  </header>

  <aside id="sidebar" class="fixed top-[90px] bottom-0 left-0 w-20 md:w-40 bg-white shadow-md flex flex-col items-center py-6 space-y-10 z-40 transform transition-transform duration-300 md:translate-x-0 -translate-x-full">
    <nav class="flex flex-col items-center w-full px-2 space-y-6">
        <a href="/home" class="sidebar-link flex flex-col items-center text-red-700 rounded-lg py-3 w-full hover:bg-red-50"><img src="assets/home.png" class="w-7 h-7 mb-1" alt="Home" /><span class="text-xs md:text-sm font-medium">Home</span></a>
        <a href="/verifikasi" class="sidebar-link flex flex-col items-center text-red-700 rounded-lg py-3 w-full hover:bg-red-50"><img src="assets/verif.png" class="w-7 h-7 mb-1" alt="Verifikasi" /><span class="text-xs md:text-sm font-medium">Verifikasi</span></a>
        <a href="/riwayat" class="sidebar-link flex flex-col items-center text-red-700 rounded-lg py-3 w-full hover:bg-red-50"><img src="assets/history.png" class="w-7 h-7 mb-1" alt="Riwayat" /><span class="text-xs md:text-sm font-medium">Riwayat</span></a>
    </nav>
  </aside>

  <div id="mainContent" class="pt-[90px] md:pl-40 transition-all duration-300">
    <div class="px-2 md:hidden">
      <button id="hamburgerBtn" class="p-2">
        <img id="hamburgerIcon" src="assets/right.png" alt="Menu" class="w-6 h-6">
      </button>
    </div>
    
    <main class="lex-1 pt-0 px-2 md:p-8 overflow-y-auto">
      <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 max-w-6xl mx-auto">
        <div class="mb-6">
          <h2 class="text-xl md:text-2xl font-bold">Selamat Datang, <span class="text-red-600">{{ user.username }}</span> ðŸ‘‹</h2>
          <p class="text-sm text-gray-600 mt-1">{{ now.strftime('%A, %d %B %Y') }}</p>
        </div>

        <div class="flex flex-col md:flex-row justify-start gap-8 mb-10">
          <div class="flex items-center bg-green-500 text-white px-6 py-5 rounded-xl shadow-md w-full md:w-[260px]">
            <img src="assets/benar.png" alt="Verifikasi Berhasil" class="h-9 w-9 mr-4 flex-shrink-0" />
            <div>
              <p class="font-bold text-lg">Verifikasi Diterima</p>
              <p class="text-sm">{{ jumlah_berhasil }} Dokumen</p>
            </div>
          </div>
          <div class="flex items-center bg-red-500 text-white px-6 py-5 rounded-xl shadow-md w-full md:w-[260px]">
            <img src="assets/salah.png" alt="Verifikasi Gagal" class="h-5 w-5 mr-4 flex-shrink-0" />
            <div>
              <p class="font-bold text-lg">Verifikasi Ditolak</p>
              <p class="text-sm">{{ jumlah_gagal }} Dokumen</p>
            </div>
          </div>
        </div>

        <div class="flex flex-col lg:flex-row justify-between gap-4 mt-6">
          <div class="overflow-x-auto rounded-lg border border-gray-200 mb-6 w-full max-w-3xl">
            <table class="w-full text-sm text-left">
              <thead class="bg-gray-100 text-gray-700 text-xs uppercase">
                <tr>
                  <th class="px-4 py-3">No</th><th class="px-4 py-3">Nama Dokumen</th><th class="px-4 py-3">Tanggal</th><th class="px-4 py-3">Status</th><th class="px-4 py-3">Skor</th>
                </tr>
              </thead>
              <tbody class="text-gray-800">
                {% for riwayat in riwayat_terbaru %}
                <tr class="border-t hover:bg-gray-50">
                  <td class="px-4 py-3">{{ loop.index }}</td>
                  <td class="px-4 py-3 font-medium text-gray-900">{{ riwayat.nama_dokumen }}</td>
                  <td class="px-4 py-3 text-gray-600">{{ riwayat.timestamp.strftime('%Y-%m-%d') }}</td>
                  <td class="px-4 py-3">
                    {% if riwayat.status == "DITERIMA" %}
                      <span class="bg-green-100 text-green-700 px-2 py-1 rounded-md text-xs font-semibold">DITERIMA</span>
                    {% else %}
                      <span class="bg-red-100 text-red-700 px-2 py-1 rounded-md text-xs font-semibold">DITOLAK</span>
                    {% endif %}
                  </td>
                  <td class="px-4 py-3 font-semibold">{{ riwayat.skor }}%</td>
                </tr>
                {% else %}
                <tr>
                  <td colspan="5" class="text-center py-10 text-gray-500">
                    Belum ada riwayat verifikasi.
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <div class="flex justify-end lg:items-end">
            <a href="/verifikasi" class="bg-red-600 text-white text-sm font-semibold px-6 py-3 rounded-xl shadow-md hover:bg-red-700 transition whitespace-nowrap h-fit">Mulai Verifikasi Baru &gt;</a>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');
    const hamburgerIcon = document.getElementById('hamburgerIcon');

    hamburgerBtn.addEventListener('click', () => {
      // Toggle sidebar visibility
      sidebar.classList.toggle('-translate-x-full');
      
      // Toggle padding di konten utama untuk memberi ruang
      mainContent.classList.toggle('pl-20');
      
      // Ganti ikon
      if (sidebar.classList.contains('-translate-x-full')) {
        hamburgerIcon.src = "assets/right.png";
      } else {
        hamburgerIcon.src = "assets/left.png";
      }
    });

    // Script Highlight Link Aktif
    document.addEventListener('DOMContentLoaded', () => {
      const currentPath = window.location.pathname;
      document.querySelectorAll('.sidebar-link').forEach(link => {
        if (link.getAttribute('href') === currentPath) {
          link.classList.add('bg-red-50', 'font-bold');
        }
      });
    });

    // Script Dropdown Profil
    const profileBtn = document.getElementById('profileBtn');
    const profileMenu = document.getElementById('profileMenu');
    document.addEventListener('click', (e) => {
      if (profileBtn.contains(e.target)) {
        profileMenu.classList.toggle('hidden');
      } else if (!profileMenu.contains(e.target)) {
        profileMenu.classList.add('hidden');
      }
    });
  </script>

</body>
</html>